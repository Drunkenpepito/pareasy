
<!-- classement general -->


<div class="backblue" id="accordion">

  <div class="cardsEvent">
    <div class="card-event event-classement ">
      <div class="card-event-line2 text-center ">

        <button class="btn btn-guost btn-lg" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" data-toggle="false" aria-controls="collapseOne">
          <h2 class="row blink_me ">
            Classement
          </h2>
        </button>

      </div>
    </div>
  </div>


  <div id="collapseOne" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">

    <table class="table table-dark table-stat">
         <thead>
           <tr>
             <th scope="col"> Poto </th>
             <th scope="col">‚Ç¨</th>
           </tr>
         </thead>
        <% @users.each do |poto| %>
         <tbody>
             <tr>
               <td> <%= poto.username %> </td>
               <td>
                  <% score = 0 %>
                  <% poto.bets.joins(:event).where(events: { bet_room_id: @bet_room.id }).each do |bet| %>
                    <% if bet.winner == true %>
                      <% score += (bet.amount_cents * bet.event.bets.count / bet.event.bets.where(winner: true).count) - bet.amount_cents %>
                    <% else %>
                      <% score -= bet.amount_cents %>
                    <% end %>
                  <% end %>
                  <%= score %>
               </td>
             </tr>
         </tbody>
       <% end %>

     </table>

  </div>

</div>






<% @events.each do |event| %>
  <% if  event.bets != []%>

    <div class="backblue" id="accordion">

      <div class="card-event">
        <div class="card-event-line1 text-center">
            <button class="btn btn-pouet btn-lg " data-toggle="collapse" data-target="#collapseOne-<%= event.id %>" aria-expanded="true" data-toggle="false" aria-controls="collapseOne">
            <%= cl_image_tag event.bets.first.user.photo.key, class: "md avatar-pouet   "%>
              <span ><strong><%= event.game %></strong></span>
              <div><%= event.description %></div>
                <% if event.winners.include?(current_user) %> <span class="justify-content-end">üèÜ</span>
                <% else event.winners.include?(current_user) %> <span class="justify-content-end"> üëé</span>
                <% end %>
              </span >
                <% if event.results == true %>
                  <span class="justify-content-end">‚úÖ</span>
                <% else %>
                  <span class="justify-content-end">‚ùå</span>
                <% end %>
            </button>
        </div>
      </div>

      <div id="collapseOne-<%= event.id %>" class="collapse " aria-labelledby="headingOne" data-parent="#accordion">
        <div class="card-body ">
          <div class="cardsEvent">
            <div class="card-event">
              <div class="card-event-line2"><h2><strong> R√©sultat ! </strong></h2></div>
              <div class="card-event-line2"><%=event.game %></div>
              <div class="card-event-line3"><%=event.description %></div>
            </div>
          </div>
        </div>

        <table class="table table-dark table-stat">
          <thead>
            <tr>
              <th scope="col">üë¶</th>
              <th scope="col">üé≤</th>
              <th scope="col">‚Ç¨</th>
            </tr>
          </thead>
          <tbody>
            <% event.users.each do |poto| %>
              <tr>
                <td><%= cl_image_tag poto.photo.key, class: "md avatar-diane "%></td>
                <td>
                  <% if event.winners.include?(poto)%>
                    üèÖ
                  <% else %>
                    üëé
                  <% end %>
                </td>
                <td>
                  <% if event.winners.include?(poto) && event.winners.count != 0 %>
                      <%= event.bets.first.amount_cents * event.users.count / event.winners.count %> ‚Ç¨
                  <% else %>
                    0 ‚Ç¨
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>


      </div> <!-- fin du collapse -->

    </div>
  <% end %>
<% end %>  <!-- end de la bouce event -->

























